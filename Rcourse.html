<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R (BGU course)</title>
  <meta name="description" content="Class notes for the R course at the BGU’s IE&amp;M dept.">
  <meta name="generator" content="bookdown <!--bookdown:version--> and GitBook 2.6.7">

  <meta property="og:title" content="R (BGU course)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Class notes for the R course at the BGU’s IE&amp;M dept." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R (BGU course)" />
  
  <meta name="twitter:description" content="Class notes for the R course at the BGU’s IE&amp;M dept." />
  

<meta name="author" content="Jonathan D. Rosenblatt">


<meta name="date" content="2018-12-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">R (BGU course)</h1>
<h4 class="author"><em>Jonathan D. Rosenblatt</em></h4>
<h4 class="date"><em>2018-12-27</em></h4>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#preface"><span class="toc-section-number">1</span> Preface</a><ul>
<li><a href="#notation-conventions"><span class="toc-section-number">1.1</span> Notation Conventions</a></li>
<li><a href="#acknowledgements"><span class="toc-section-number">1.2</span> Acknowledgements</a></li>
</ul></li>
<li><a href="#plotting"><span class="toc-section-number">2</span> Plotting</a><ul>
<li><a href="#the-graphics-system"><span class="toc-section-number">2.1</span> The graphics System</a><ul>
<li><a href="#using-existing-plotting-functions"><span class="toc-section-number">2.1.1</span> Using Existing Plotting Functions</a></li>
<li><a href="#exporting-a-plot"><span class="toc-section-number">2.1.2</span> Exporting a Plot</a></li>
<li><a href="#fancy"><span class="toc-section-number">2.1.3</span> Fancy graphics Examples</a></li>
</ul></li>
<li><a href="#the-ggplot2-system"><span class="toc-section-number">2.2</span> The ggplot2 System</a><ul>
<li><a href="#extensions-of-the-ggplot2-system"><span class="toc-section-number">2.2.1</span> Extensions of the ggplot2 System</a></li>
</ul></li>
<li><a href="#interactive-graphics"><span class="toc-section-number">2.3</span> Interactive Graphics</a><ul>
<li><a href="#plotly"><span class="toc-section-number">2.3.1</span> Plotly</a></li>
</ul></li>
<li><a href="#r2d3"><span class="toc-section-number">2.4</span> r2d3</a></li>
<li><a href="#bibliographic-notes"><span class="toc-section-number">2.5</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself"><span class="toc-section-number">2.6</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#intro"><span class="toc-section-number">3</span> Introduction</a><ul>
<li><a href="#what-r"><span class="toc-section-number">3.1</span> What is R?</a></li>
<li><a href="#ecosystem"><span class="toc-section-number">3.2</span> The R Ecosystem</a></li>
<li><a href="#bibliographic-notes-1"><span class="toc-section-number">3.3</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-1"><span class="toc-section-number">3.4</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#report"><span class="toc-section-number">4</span> Reports</a><ul>
<li><a href="#knitr"><span class="toc-section-number">4.1</span> knitr</a><ul>
<li><a href="#installation"><span class="toc-section-number">4.1.1</span> Installation</a></li>
<li><a href="#pandoc-markdown"><span class="toc-section-number">4.1.2</span> Pandoc Markdown</a></li>
<li><a href="#rmarkdown"><span class="toc-section-number">4.1.3</span> Rmarkdown</a></li>
<li><a href="#bibtex"><span class="toc-section-number">4.1.4</span> BibTex</a></li>
<li><a href="#compiling"><span class="toc-section-number">4.1.5</span> Compiling</a></li>
</ul></li>
<li><a href="#bookdown"><span class="toc-section-number">4.2</span> bookdown</a></li>
<li><a href="#shiny"><span class="toc-section-number">4.3</span> Shiny</a><ul>
<li><a href="#installation-1"><span class="toc-section-number">4.3.1</span> Installation</a></li>
<li><a href="#the-basics-of-shiny"><span class="toc-section-number">4.3.2</span> The Basics of Shiny</a></li>
<li><a href="#beyond-the-basics"><span class="toc-section-number">4.3.3</span> Beyond the Basics</a></li>
<li><a href="#shinydashboard"><span class="toc-section-number">4.3.4</span> shinydashboard</a></li>
</ul></li>
<li><a href="#flexdashboard"><span class="toc-section-number">4.4</span> flexdashboard</a></li>
<li><a href="#bibliographic-notes-2"><span class="toc-section-number">4.5</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-2"><span class="toc-section-number">4.6</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#sparse"><span class="toc-section-number">5</span> Sparse Representations</a><ul>
<li><a href="#sparse-matrix-representations"><span class="toc-section-number">5.1</span> Sparse Matrix Representations</a><ul>
<li><a href="#coo"><span class="toc-section-number">5.1.1</span> Coordinate List Representation</a></li>
<li><a href="#compressed-column-oriented-representation"><span class="toc-section-number">5.1.2</span> Compressed Column Oriented Representation</a></li>
<li><a href="#compressed-row-oriented-representation"><span class="toc-section-number">5.1.3</span> Compressed Row Oriented Representation</a></li>
<li><a href="#sparse-algorithms"><span class="toc-section-number">5.1.4</span> Sparse Algorithms</a></li>
</ul></li>
<li><a href="#sparse-matrices-and-sparse-models-in-r"><span class="toc-section-number">5.2</span> Sparse Matrices and Sparse Models in R</a><ul>
<li><a href="#the-matrix-package"><span class="toc-section-number">5.2.1</span> The Matrix Package</a></li>
<li><a href="#the-matrixmodels-package"><span class="toc-section-number">5.2.2</span> The MatrixModels Package</a></li>
<li><a href="#the-glmnet-package"><span class="toc-section-number">5.2.3</span> The glmnet Package</a></li>
<li><a href="#the-sparsem-package"><span class="toc-section-number">5.2.4</span> The SparseM Package</a></li>
</ul></li>
<li><a href="#bibliographic-notes-3"><span class="toc-section-number">5.3</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-3"><span class="toc-section-number">5.4</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#memory"><span class="toc-section-number">6</span> Memory Efficiency</a><ul>
<li><a href="#efficient-computing-from-ram"><span class="toc-section-number">6.1</span> Efficient Computing from RAM</a><ul>
<li><a href="#summary-statistics-from-ram"><span class="toc-section-number">6.1.1</span> Summary Statistics from RAM</a></li>
</ul></li>
<li><a href="#computing-from-a-database"><span class="toc-section-number">6.2</span> Computing from a Database</a></li>
<li><a href="#file-structure"><span class="toc-section-number">6.3</span> Computing From Efficient File Structrures</a><ul>
<li><a href="#bigmemory"><span class="toc-section-number">6.3.1</span> bigmemory</a></li>
</ul></li>
<li><a href="#ff"><span class="toc-section-number">6.4</span> ff</a></li>
<li><a href="#matter"><span class="toc-section-number">6.5</span> matter</a></li>
<li><a href="#iotools"><span class="toc-section-number">6.6</span> iotools</a></li>
<li><a href="#hdf5"><span class="toc-section-number">6.7</span> HDF5</a></li>
<li><a href="#delayedarray"><span class="toc-section-number">6.8</span> DelayedArray</a><ul>
<li><a href="#delayedmatrixstats"><span class="toc-section-number">6.8.1</span> DelayedMatrixStats</a></li>
<li><a href="#beachmat"><span class="toc-section-number">6.8.2</span> beachmat</a></li>
<li><a href="#restfulse"><span class="toc-section-number">6.8.3</span> restfulSE</a></li>
</ul></li>
<li><a href="#computing-from-a-distributed-file-system"><span class="toc-section-number">6.9</span> Computing from a Distributed File System</a></li>
<li><a href="#bibliographic-notes-4"><span class="toc-section-number">6.10</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-4"><span class="toc-section-number">6.11</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#parallel"><span class="toc-section-number">7</span> Parallel Computing</a><ul>
<li><a href="#implicit-parallelism"><span class="toc-section-number">7.1</span> Implicit Parallelism</a></li>
<li><a href="#explicit-parallelism"><span class="toc-section-number">7.2</span> Explicit Parallelism</a><ul>
<li><a href="#caution-implicit-with-explicit-parallelism"><span class="toc-section-number">7.2.1</span> Caution: Implicit with Explicit Parallelism</a></li>
</ul></li>
<li><a href="#bibliographic-notes-5"><span class="toc-section-number">7.3</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-5"><span class="toc-section-number">7.4</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#algebra"><span class="toc-section-number">8</span> Numerical Linear Algebra</a><ul>
<li><a href="#lu-factorization"><span class="toc-section-number">8.1</span> LU Factorization</a></li>
<li><a href="#cholesky-factorization"><span class="toc-section-number">8.2</span> Cholesky Factorization</a></li>
<li><a href="#qr-factorization"><span class="toc-section-number">8.3</span> QR Factorization</a></li>
<li><a href="#singular-value-factorization"><span class="toc-section-number">8.4</span> Singular Value Factorization</a></li>
<li><a href="#iterative-methods"><span class="toc-section-number">8.5</span> Iterative Methods</a></li>
<li><a href="#solving-ols"><span class="toc-section-number">8.6</span> Solving the OLS Problem</a></li>
<li><a href="#bibliographic-notes-6"><span class="toc-section-number">8.7</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-6"><span class="toc-section-number">8.8</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#convex"><span class="toc-section-number">9</span> Convex Optimization</a><ul>
<li><a href="#theoretical-backround"><span class="toc-section-number">9.1</span> Theoretical Backround</a></li>
<li><a href="#optimizing-with-r"><span class="toc-section-number">9.2</span> Optimizing with R</a><ul>
<li><a href="#the-optim-function"><span class="toc-section-number">9.2.1</span> The optim Function</a></li>
<li><a href="#the-nloptr-package"><span class="toc-section-number">9.2.2</span> The nloptr Package</a></li>
<li><a href="#minqa-package"><span class="toc-section-number">9.2.3</span> minqa Package</a></li>
</ul></li>
<li><a href="#bibliographic-notes-7"><span class="toc-section-number">9.3</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-7"><span class="toc-section-number">9.4</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#rcpp"><span class="toc-section-number">10</span> RCpp</a><ul>
<li><a href="#bibliographic-notes-8"><span class="toc-section-number">10.1</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-8"><span class="toc-section-number">10.2</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#debugging"><span class="toc-section-number">11</span> Debugging Tools</a><ul>
<li><a href="#bibliographic-notes-9"><span class="toc-section-number">11.1</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-9"><span class="toc-section-number">11.2</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#basics"><span class="toc-section-number">12</span> R Basics</a><ul>
<li><a href="#other-ides"><span class="toc-section-number">12.0.1</span> Other IDEs</a></li>
<li><a href="#file-types"><span class="toc-section-number">12.1</span> File types</a></li>
<li><a href="#simple-calculator"><span class="toc-section-number">12.2</span> Simple calculator</a></li>
<li><a href="#probability-calculator"><span class="toc-section-number">12.3</span> Probability calculator</a></li>
<li><a href="#getting-help"><span class="toc-section-number">12.4</span> Getting Help</a></li>
<li><a href="#variable-asignment"><span class="toc-section-number">12.5</span> Variable Asignment</a></li>
<li><a href="#missing"><span class="toc-section-number">12.6</span> Missing</a></li>
<li><a href="#piping"><span class="toc-section-number">12.7</span> Piping</a></li>
<li><a href="#vector-creation-and-manipulation"><span class="toc-section-number">12.8</span> Vector Creation and Manipulation</a></li>
<li><a href="#search-paths-and-packages"><span class="toc-section-number">12.9</span> Search Paths and Packages</a></li>
<li><a href="#simple-plotting"><span class="toc-section-number">12.10</span> Simple Plotting</a></li>
<li><a href="#object-types"><span class="toc-section-number">12.11</span> Object Types</a></li>
<li><a href="#data-frames"><span class="toc-section-number">12.12</span> Data Frames</a></li>
<li><a href="#exctraction"><span class="toc-section-number">12.13</span> Exctraction</a></li>
<li><a href="#augmentations-of-the-data.frame-class"><span class="toc-section-number">12.14</span> Augmentations of the data.frame class</a></li>
<li><a href="#data-import-and-export"><span class="toc-section-number">12.15</span> Data Import and Export</a><ul>
<li><a href="#import-from-web"><span class="toc-section-number">12.15.1</span> Import from WEB</a></li>
<li><a href="#export-as-csv"><span class="toc-section-number">12.15.2</span> Export as CSV</a></li>
<li><a href="#export-non-csv-files"><span class="toc-section-number">12.15.3</span> Export non-CSV files</a></li>
<li><a href="#reading-from-text-files"><span class="toc-section-number">12.15.4</span> Reading From Text Files</a></li>
<li><a href="#writing-data-to-text-files"><span class="toc-section-number">12.15.5</span> Writing Data to Text Files</a></li>
<li><a href="#xlsx-files"><span class="toc-section-number">12.15.6</span> .XLS(X) files</a></li>
<li><a href="#massive-files"><span class="toc-section-number">12.15.7</span> Massive files</a></li>
<li><a href="#databases"><span class="toc-section-number">12.15.8</span> Databases</a></li>
</ul></li>
<li><a href="#functions"><span class="toc-section-number">12.16</span> Functions</a></li>
<li><a href="#looping"><span class="toc-section-number">12.17</span> Looping</a></li>
<li><a href="#apply"><span class="toc-section-number">12.18</span> Apply</a></li>
<li><a href="#recursion"><span class="toc-section-number">12.19</span> Recursion</a></li>
<li><a href="#dates-and-times"><span class="toc-section-number">12.20</span> Dates and Times</a></li>
<li><a href="#bibliographic-notes-10"><span class="toc-section-number">12.21</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-10"><span class="toc-section-number">12.22</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#econometrics"><span class="toc-section-number">13</span> Econometrics</a><ul>
<li><a href="#bibliographic-notes-11"><span class="toc-section-number">13.1</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-11"><span class="toc-section-number">13.2</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#datatable"><span class="toc-section-number">14</span> data.table</a><ul>
<li><a href="#make-your-own-variables"><span class="toc-section-number">14.1</span> Make your own variables</a></li>
<li><a href="#join"><span class="toc-section-number">14.2</span> Join</a></li>
<li><a href="#reshaping-data"><span class="toc-section-number">14.3</span> Reshaping data</a><ul>
<li><a href="#wide-to-long"><span class="toc-section-number">14.3.1</span> Wide to long</a></li>
<li><a href="#long-to-wide"><span class="toc-section-number">14.3.2</span> Long to wide</a></li>
</ul></li>
<li><a href="#bibliographic-notes-12"><span class="toc-section-number">14.4</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-12"><span class="toc-section-number">14.5</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#psychometrics"><span class="toc-section-number">15</span> Psychometrics</a><ul>
<li><a href="#bibliographic-notes-13"><span class="toc-section-number">15.1</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-13"><span class="toc-section-number">15.2</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#hadley"><span class="toc-section-number">16</span> The Hadleyverse</a><ul>
<li><a href="#readr"><span class="toc-section-number">16.1</span> readr</a></li>
<li><a href="#dplyr"><span class="toc-section-number">16.2</span> dplyr</a></li>
<li><a href="#tidyr"><span class="toc-section-number">16.3</span> tidyr</a></li>
<li><a href="#reshape2"><span class="toc-section-number">16.4</span> reshape2</a></li>
<li><a href="#stringr"><span class="toc-section-number">16.5</span> stringr</a></li>
<li><a href="#anytime"><span class="toc-section-number">16.6</span> anytime</a></li>
<li><a href="#biblipgraphic-notes"><span class="toc-section-number">16.7</span> Biblipgraphic Notes</a></li>
<li><a href="#practice-yourself-14"><span class="toc-section-number">16.8</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#causality"><span class="toc-section-number">17</span> Causal Inferense</a><ul>
<li><a href="#causal-inference-from-designed-experiments"><span class="toc-section-number">17.1</span> Causal Inference From Designed Experiments</a><ul>
<li><a href="#design-of-experiments"><span class="toc-section-number">17.1.1</span> Design of Experiments</a></li>
<li><a href="#randomized-inference"><span class="toc-section-number">17.1.2</span> Randomized Inference</a></li>
</ul></li>
<li><a href="#causal-inference-from-observational-data"><span class="toc-section-number">17.2</span> Causal Inference from Observational Data</a><ul>
<li><a href="#principal-stratification"><span class="toc-section-number">17.2.1</span> Principal Stratification</a></li>
<li><a href="#instrumental-variables"><span class="toc-section-number">17.2.2</span> Instrumental Variables</a></li>
<li><a href="#propensity-scores"><span class="toc-section-number">17.2.3</span> Propensity Scores</a></li>
<li><a href="#direct-lieklihood"><span class="toc-section-number">17.2.4</span> Direct Lieklihood</a></li>
<li><a href="#regression-discontinuity"><span class="toc-section-number">17.2.5</span> Regression Discontinuity</a></li>
</ul></li>
<li><a href="#bibliographic-notes-14"><span class="toc-section-number">17.3</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-15"><span class="toc-section-number">17.4</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#eda"><span class="toc-section-number">18</span> Exploratory Data Analysis</a><ul>
<li><a href="#summary-statistics"><span class="toc-section-number">18.1</span> Summary Statistics</a><ul>
<li><a href="#categorical-data"><span class="toc-section-number">18.1.1</span> Categorical Data</a></li>
<li><a href="#continous-data"><span class="toc-section-number">18.1.2</span> Continous Data</a></li>
</ul></li>
<li><a href="#visualization"><span class="toc-section-number">18.2</span> Visualization</a><ul>
<li><a href="#categorical-data-1"><span class="toc-section-number">18.2.1</span> Categorical Data</a></li>
<li><a href="#continuous-data"><span class="toc-section-number">18.2.2</span> Continuous Data</a></li>
</ul></li>
<li><a href="#mixed-type-data"><span class="toc-section-number">18.3</span> Mixed Type Data</a><ul>
<li><a href="#alluvian-diagram"><span class="toc-section-number">18.3.1</span> Alluvian Diagram</a></li>
</ul></li>
<li><a href="#bibliographic-notes-15"><span class="toc-section-number">18.4</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-16"><span class="toc-section-number">18.5</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#lm"><span class="toc-section-number">19</span> Linear Models</a><ul>
<li><a href="#problem-setup"><span class="toc-section-number">19.1</span> Problem Setup</a></li>
<li><a href="#ols-estimation-in-r"><span class="toc-section-number">19.2</span> OLS Estimation in R</a></li>
<li><a href="#inference"><span class="toc-section-number">19.3</span> Inference</a><ul>
<li><a href="#testing-a-hypothesis-on-a-single-coefficient"><span class="toc-section-number">19.3.1</span> Testing a Hypothesis on a Single Coefficient</a></li>
<li><a href="#constructing-a-confidence-interval-on-a-single-coefficient"><span class="toc-section-number">19.3.2</span> Constructing a Confidence Interval on a Single Coefficient</a></li>
<li><a href="#multiple-regression"><span class="toc-section-number">19.3.3</span> Multiple Regression</a></li>
<li><a href="#anova-testing-a-hypothesis-on-a-single-contrast"><span class="toc-section-number">19.3.4</span> ANOVA (<em>) ### Testing a Hypothesis on a Single Contrast (</em>)</a></li>
</ul></li>
<li><a href="#bibliographic-notes-16"><span class="toc-section-number">19.4</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-17"><span class="toc-section-number">19.5</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#glm"><span class="toc-section-number">20</span> Generalized Linear Models</a><ul>
<li><a href="#problem-setup-1"><span class="toc-section-number">20.1</span> Problem Setup</a></li>
<li><a href="#logistic-regression"><span class="toc-section-number">20.2</span> Logistic Regression</a><ul>
<li><a href="#logistic-regression-with-r"><span class="toc-section-number">20.2.1</span> Logistic Regression with R</a></li>
</ul></li>
<li><a href="#poisson-regression"><span class="toc-section-number">20.3</span> Poisson Regression</a></li>
<li><a href="#extensions"><span class="toc-section-number">20.4</span> Extensions</a></li>
<li><a href="#bibliographic-notes-17"><span class="toc-section-number">20.5</span> Bibliographic Notes</a></li>
<li><a href="#practice-glm"><span class="toc-section-number">20.6</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#lme"><span class="toc-section-number">21</span> Linear Mixed Models</a><ul>
<li><a href="#problem-setup-2"><span class="toc-section-number">21.1</span> Problem Setup</a><ul>
<li><a href="#non-linear-mixed-models"><span class="toc-section-number">21.1.1</span> Non-Linear Mixed Models</a></li>
<li><a href="#generalized-linear-mixed-models-glmm"><span class="toc-section-number">21.1.2</span> Generalized Linear Mixed Models (GLMM)</a></li>
</ul></li>
<li><a href="#mixed-models-with-r"><span class="toc-section-number">21.2</span> Mixed Models with R</a><ul>
<li><a href="#a-single-random-effect"><span class="toc-section-number">21.2.1</span> A Single Random Effect</a></li>
<li><a href="#multiple-random-effects"><span class="toc-section-number">21.2.2</span> Multiple Random Effects</a></li>
<li><a href="#a-full-mixed-model"><span class="toc-section-number">21.2.3</span> A Full Mixed-Model</a></li>
</ul></li>
<li><a href="#serial"><span class="toc-section-number">21.3</span> Serial Correlations</a></li>
<li><a href="#extensions-1"><span class="toc-section-number">21.4</span> Extensions</a><ul>
<li><a href="#cluster-robust-standard-errors"><span class="toc-section-number">21.4.1</span> Cluster Robust Standard Errors</a></li>
<li><a href="#linear-models-for-panel-data"><span class="toc-section-number">21.4.2</span> Linear Models for Panel Data</a></li>
<li><a href="#testing-hypotheses-on-correlations"><span class="toc-section-number">21.4.3</span> Testing Hypotheses on Correlations</a></li>
</ul></li>
<li><a href="#relation-to-other-estimators"><span class="toc-section-number">21.5</span> Relation to Other Estimators</a><ul>
<li><a href="#fixed-effects-in-the-econometric-literature"><span class="toc-section-number">21.5.1</span> Fixed Effects in the Econometric Literature</a></li>
<li><a href="#relation-to-generalized-least-squares-gls"><span class="toc-section-number">21.5.2</span> Relation to Generalized Least Squares (GLS)</a></li>
<li><a href="#relation-to-conditional-gaussian-fields"><span class="toc-section-number">21.5.3</span> Relation to Conditional Gaussian Fields</a></li>
<li><a href="#relation-to-empirical-risk-minimization-erm"><span class="toc-section-number">21.5.4</span> Relation to Empirical Risk Minimization (ERM)</a></li>
<li><a href="#relation-to-m-estimation"><span class="toc-section-number">21.5.5</span> Relation to M-Estimation</a></li>
<li><a href="#relation-to-generalize-estimating-equations-gee"><span class="toc-section-number">21.5.6</span> Relation to Generalize Estimating Equations (GEE)</a></li>
<li><a href="#manova"><span class="toc-section-number">21.5.7</span> Relation to MANOVA</a></li>
<li><a href="#relation-to-seemingly-unrelated-equations-sur"><span class="toc-section-number">21.5.8</span> Relation to Seemingly Unrelated Equations (SUR)</a></li>
</ul></li>
<li><a href="#the-variance-components-view"><span class="toc-section-number">21.6</span> The Variance-Components View</a></li>
<li><a href="#bibliographic-notes-18"><span class="toc-section-number">21.7</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-18"><span class="toc-section-number">21.8</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#multivariate"><span class="toc-section-number">22</span> Multivariate Data Analysis</a><ul>
<li><a href="#signal-detection"><span class="toc-section-number">22.1</span> Signal Detection</a><ul>
<li><a href="#hotellings-t2-test"><span class="toc-section-number">22.1.1</span> Hotelling’s T2 Test</a></li>
<li><a href="#various-types-of-signal-to-detect"><span class="toc-section-number">22.1.2</span> Various Types of Signal to Detect</a></li>
<li><a href="#simes-test"><span class="toc-section-number">22.1.3</span> Simes’ Test</a></li>
<li><a href="#signal-detection-with-r"><span class="toc-section-number">22.1.4</span> Signal Detection with R</a></li>
</ul></li>
<li><a href="#signal-counting"><span class="toc-section-number">22.2</span> Signal Counting</a></li>
<li><a href="#identification"><span class="toc-section-number">22.3</span> Signal Identification</a><ul>
<li><a href="#signal-identification-in-r"><span class="toc-section-number">22.3.1</span> Signal Identification in R</a></li>
</ul></li>
<li><a href="#signal-estimation-multivariate-regression"><span class="toc-section-number">22.4</span> Signal Estimation (<em>) ## Multivariate Regression (</em>)</a><ul>
<li><a href="#multivariate-regression-with-r"><span class="toc-section-number">22.4.1</span> Multivariate Regression with R</a></li>
</ul></li>
<li><a href="#graphical-models-graphical-models-in-r-biblipgraphic-notes-practice-yourself"><span class="toc-section-number">22.5</span> Graphical Models (*) ### Graphical Models in R ## Biblipgraphic Notes ## Practice Yourself</a></li>
</ul></li>
<li><a href="#supervised"><span class="toc-section-number">23</span> Supervised Learning</a><ul>
<li><a href="#problem-setup-3"><span class="toc-section-number">23.1</span> Problem Setup</a><ul>
<li><a href="#common-hypothesis-classes"><span class="toc-section-number">23.1.1</span> Common Hypothesis Classes</a></li>
<li><a href="#common-complexity-penalties"><span class="toc-section-number">23.1.2</span> Common Complexity Penalties</a></li>
<li><a href="#unbiased-risk-estimation"><span class="toc-section-number">23.1.3</span> Unbiased Risk Estimation</a></li>
<li><a href="#collecting-the-pieces"><span class="toc-section-number">23.1.4</span> Collecting the Pieces</a></li>
</ul></li>
<li><a href="#supervised-learning-in-r"><span class="toc-section-number">23.2</span> Supervised Learning in R</a><ul>
<li><a href="#least-squares"><span class="toc-section-number">23.2.1</span> Linear Models with Least Squares Loss</a></li>
<li><a href="#svm"><span class="toc-section-number">23.2.2</span> SVM</a></li>
<li><a href="#neural-nets"><span class="toc-section-number">23.2.3</span> Neural Nets</a></li>
<li><a href="#classification-and-regression-trees-cart"><span class="toc-section-number">23.2.4</span> Classification and Regression Trees (CART)</a></li>
<li><a href="#k-nearest-neighbour-knn"><span class="toc-section-number">23.2.5</span> K-nearest neighbour (KNN)</a></li>
<li><a href="#linear-discriminant-analysis-lda"><span class="toc-section-number">23.2.6</span> Linear Discriminant Analysis (LDA)</a></li>
<li><a href="#naive-bayes"><span class="toc-section-number">23.2.7</span> Naive Bayes</a></li>
<li><a href="#random-forrest"><span class="toc-section-number">23.2.8</span> Random Forrest</a></li>
<li><a href="#gradient-boosting"><span class="toc-section-number">23.2.9</span> Gradient Boosting</a></li>
</ul></li>
<li><a href="#bibliographic-notes-19"><span class="toc-section-number">23.3</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-19"><span class="toc-section-number">23.4</span> Practice Yourself</a></li>
</ul></li>
<li><a href="#unsupervised"><span class="toc-section-number">24</span> Unsupervised Learning</a><ul>
<li><a href="#dim-reduce"><span class="toc-section-number">24.1</span> Dimensionality Reduction</a><ul>
<li><a href="#pca"><span class="toc-section-number">24.1.1</span> Principal Component Analysis</a></li>
<li><a href="#dimensionality-reduction-preliminaries"><span class="toc-section-number">24.1.2</span> Dimensionality Reduction Preliminaries</a></li>
<li><a href="#latent-variable-generative-approaches"><span class="toc-section-number">24.1.3</span> Latent Variable Generative Approaches</a></li>
<li><a href="#purely-algorithmic-approaches"><span class="toc-section-number">24.1.4</span> Purely Algorithmic Approaches</a></li>
<li><a href="#dimensionality-reduction-in-r"><span class="toc-section-number">24.1.5</span> Dimensionality Reduction in R</a></li>
</ul></li>
<li><a href="#cluster"><span class="toc-section-number">24.2</span> Clustering</a><ul>
<li><a href="#latent-variable-generative-approaches-1"><span class="toc-section-number">24.2.1</span> Latent Variable Generative Approaches</a></li>
<li><a href="#purely-algorithmic-approaches-1"><span class="toc-section-number">24.2.2</span> Purely Algorithmic Approaches</a></li>
<li><a href="#clustering-in-r"><span class="toc-section-number">24.2.3</span> Clustering in R</a></li>
</ul></li>
<li><a href="#bibliographic-notes-20"><span class="toc-section-number">24.3</span> Bibliographic Notes</a></li>
<li><a href="#practice-yourself-20"><span class="toc-section-number">24.4</span> Practice Yourself</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R (BGU course)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="preface" class="section level1">
<h1><span class="header-section-number">1</span> Preface</h1>
<div id="notation-conventions" class="section level2">
<h2><span class="header-section-number">1.1</span> Notation Conventions</h2>
</div>
<div id="acknowledgements" class="section level2">
<h2><span class="header-section-number">1.2</span> Acknowledgements</h2>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="plotting" class="section level1">
<h1><span class="header-section-number">2</span> Plotting</h1>
<div id="the-graphics-system" class="section level2">
<h2><span class="header-section-number">2.1</span> The graphics System</h2>
<div id="using-existing-plotting-functions" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Using Existing Plotting Functions</h3>
<div id="scatter-plot" class="section level4">
<h4><span class="header-section-number">2.1.1.1</span> Scatter Plot</h4>
</div>
</div>
<div id="exporting-a-plot" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Exporting a Plot</h3>
</div>
<div id="fancy" class="section level3">
<h3><span class="header-section-number">2.1.3</span> Fancy graphics Examples</h3>
<div id="line-graph" class="section level4">
<h4><span class="header-section-number">2.1.3.1</span> Line Graph</h4>
</div>
<div id="rosette" class="section level4">
<h4><span class="header-section-number">2.1.3.2</span> Rosette</h4>
</div>
<div id="arrows" class="section level4">
<h4><span class="header-section-number">2.1.3.3</span> Arrows</h4>
</div>
<div id="arrows-as-error-bars" class="section level4">
<h4><span class="header-section-number">2.1.3.4</span> Arrows as error bars</h4>
</div>
<div id="histogram" class="section level4">
<h4><span class="header-section-number">2.1.3.5</span> Histogram</h4>
<div id="spiral-squares" class="section level5">
<h5><span class="header-section-number">2.1.3.5.1</span> Spiral Squares</h5>
</div>
</div>
<div id="circles" class="section level4">
<h4><span class="header-section-number">2.1.3.6</span> Circles</h4>
</div>
<div id="spiral" class="section level4">
<h4><span class="header-section-number">2.1.3.7</span> Spiral</h4>
</div>
</div>
</div>
<div id="the-ggplot2-system" class="section level2">
<h2><span class="header-section-number">2.2</span> The ggplot2 System</h2>
<div id="extensions-of-the-ggplot2-system" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Extensions of the ggplot2 System</h3>
</div>
</div>
<div id="interactive-graphics" class="section level2">
<h2><span class="header-section-number">2.3</span> Interactive Graphics</h2>
<div id="plotly" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Plotly</h3>
</div>
</div>
<div id="r2d3" class="section level2">
<h2><span class="header-section-number">2.4</span> r2d3</h2>
</div>
<div id="bibliographic-notes" class="section level2">
<h2><span class="header-section-number">2.5</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself" class="section level2">
<h2><span class="header-section-number">2.6</span> Practice Yourself</h2>
<!--chapter:end:100-plotting.Rmd-->
</div>
</div>
<div id="intro" class="section level1">
<h1><span class="header-section-number">3</span> Introduction</h1>
<div id="what-r" class="section level2">
<h2><span class="header-section-number">3.1</span> What is R?</h2>
</div>
<div id="ecosystem" class="section level2">
<h2><span class="header-section-number">3.2</span> The R Ecosystem</h2>
</div>
<div id="bibliographic-notes-1" class="section level2">
<h2><span class="header-section-number">3.3</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-1" class="section level2">
<h2><span class="header-section-number">3.4</span> Practice Yourself</h2>
<!--chapter:end:10-intro.Rmd-->
</div>
</div>
<div id="report" class="section level1">
<h1><span class="header-section-number">4</span> Reports</h1>
<div id="knitr" class="section level2">
<h2><span class="header-section-number">4.1</span> knitr</h2>
<div id="installation" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Installation</h3>
</div>
<div id="pandoc-markdown" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Pandoc Markdown</h3>
</div>
<div id="rmarkdown" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Rmarkdown</h3>
</div>
<div id="bibtex" class="section level3">
<h3><span class="header-section-number">4.1.4</span> BibTex</h3>
</div>
<div id="compiling" class="section level3">
<h3><span class="header-section-number">4.1.5</span> Compiling</h3>
</div>
</div>
<div id="bookdown" class="section level2">
<h2><span class="header-section-number">4.2</span> bookdown</h2>
</div>
<div id="shiny" class="section level2">
<h2><span class="header-section-number">4.3</span> Shiny</h2>
<div id="installation-1" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Installation</h3>
</div>
<div id="the-basics-of-shiny" class="section level3">
<h3><span class="header-section-number">4.3.2</span> The Basics of Shiny</h3>
</div>
<div id="beyond-the-basics" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Beyond the Basics</h3>
<div id="widgets" class="section level4">
<h4><span class="header-section-number">4.3.3.1</span> Widgets</h4>
</div>
<div id="output-elements" class="section level4">
<h4><span class="header-section-number">4.3.3.2</span> Output Elements</h4>
</div>
</div>
<div id="shinydashboard" class="section level3">
<h3><span class="header-section-number">4.3.4</span> shinydashboard</h3>
</div>
</div>
<div id="flexdashboard" class="section level2">
<h2><span class="header-section-number">4.4</span> flexdashboard</h2>
</div>
<div id="bibliographic-notes-2" class="section level2">
<h2><span class="header-section-number">4.5</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-2" class="section level2">
<h2><span class="header-section-number">4.6</span> Practice Yourself</h2>
<!--chapter:end:110-reporting.Rmd-->
</div>
</div>
<div id="sparse" class="section level1">
<h1><span class="header-section-number">5</span> Sparse Representations</h1>
<div id="sparse-matrix-representations" class="section level2">
<h2><span class="header-section-number">5.1</span> Sparse Matrix Representations</h2>
<div id="coo" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Coordinate List Representation</h3>
</div>
<div id="compressed-column-oriented-representation" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Compressed Column Oriented Representation</h3>
</div>
<div id="compressed-row-oriented-representation" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Compressed Row Oriented Representation</h3>
</div>
<div id="sparse-algorithms" class="section level3">
<h3><span class="header-section-number">5.1.4</span> Sparse Algorithms</h3>
</div>
</div>
<div id="sparse-matrices-and-sparse-models-in-r" class="section level2">
<h2><span class="header-section-number">5.2</span> Sparse Matrices and Sparse Models in R</h2>
<div id="the-matrix-package" class="section level3">
<h3><span class="header-section-number">5.2.1</span> The Matrix Package</h3>
</div>
<div id="the-matrixmodels-package" class="section level3">
<h3><span class="header-section-number">5.2.2</span> The MatrixModels Package</h3>
</div>
<div id="the-glmnet-package" class="section level3">
<h3><span class="header-section-number">5.2.3</span> The glmnet Package</h3>
</div>
<div id="the-sparsem-package" class="section level3">
<h3><span class="header-section-number">5.2.4</span> The SparseM Package</h3>
</div>
</div>
<div id="bibliographic-notes-3" class="section level2">
<h2><span class="header-section-number">5.3</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-3" class="section level2">
<h2><span class="header-section-number">5.4</span> Practice Yourself</h2>
<!--chapter:end:130-sparsity.Rmd-->
</div>
</div>
<div id="memory" class="section level1">
<h1><span class="header-section-number">6</span> Memory Efficiency</h1>
<div id="efficient-computing-from-ram" class="section level2">
<h2><span class="header-section-number">6.1</span> Efficient Computing from RAM</h2>
<div id="summary-statistics-from-ram" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Summary Statistics from RAM</h3>
</div>
</div>
<div id="computing-from-a-database" class="section level2">
<h2><span class="header-section-number">6.2</span> Computing from a Database</h2>
</div>
<div id="file-structure" class="section level2">
<h2><span class="header-section-number">6.3</span> Computing From Efficient File Structrures</h2>
<div id="bigmemory" class="section level3">
<h3><span class="header-section-number">6.3.1</span> bigmemory</h3>
</div>
</div>
<div id="ff" class="section level2">
<h2><span class="header-section-number">6.4</span> ff</h2>
</div>
<div id="matter" class="section level2">
<h2><span class="header-section-number">6.5</span> matter</h2>
</div>
<div id="iotools" class="section level2">
<h2><span class="header-section-number">6.6</span> iotools</h2>
</div>
<div id="hdf5" class="section level2">
<h2><span class="header-section-number">6.7</span> HDF5</h2>
</div>
<div id="delayedarray" class="section level2">
<h2><span class="header-section-number">6.8</span> DelayedArray</h2>
<div id="delayedmatrixstats" class="section level3">
<h3><span class="header-section-number">6.8.1</span> DelayedMatrixStats</h3>
</div>
<div id="beachmat" class="section level3">
<h3><span class="header-section-number">6.8.2</span> beachmat</h3>
</div>
<div id="restfulse" class="section level3">
<h3><span class="header-section-number">6.8.3</span> restfulSE</h3>
</div>
</div>
<div id="computing-from-a-distributed-file-system" class="section level2">
<h2><span class="header-section-number">6.9</span> Computing from a Distributed File System</h2>
</div>
<div id="bibliographic-notes-4" class="section level2">
<h2><span class="header-section-number">6.10</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-4" class="section level2">
<h2><span class="header-section-number">6.11</span> Practice Yourself</h2>
<!--chapter:end:140-memory.Rmd-->
</div>
</div>
<div id="parallel" class="section level1">
<h1><span class="header-section-number">7</span> Parallel Computing</h1>
<div id="implicit-parallelism" class="section level2">
<h2><span class="header-section-number">7.1</span> Implicit Parallelism</h2>
</div>
<div id="explicit-parallelism" class="section level2">
<h2><span class="header-section-number">7.2</span> Explicit Parallelism</h2>
<div id="caution-implicit-with-explicit-parallelism" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Caution: Implicit with Explicit Parallelism</h3>
</div>
</div>
<div id="bibliographic-notes-5" class="section level2">
<h2><span class="header-section-number">7.3</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-5" class="section level2">
<h2><span class="header-section-number">7.4</span> Practice Yourself</h2>
<!--chapter:end:150-parallel.Rmd-->
</div>
</div>
<div id="algebra" class="section level1">
<h1><span class="header-section-number">8</span> Numerical Linear Algebra</h1>
<div id="lu-factorization" class="section level2">
<h2><span class="header-section-number">8.1</span> LU Factorization</h2>
</div>
<div id="cholesky-factorization" class="section level2">
<h2><span class="header-section-number">8.2</span> Cholesky Factorization</h2>
</div>
<div id="qr-factorization" class="section level2">
<h2><span class="header-section-number">8.3</span> QR Factorization</h2>
</div>
<div id="singular-value-factorization" class="section level2">
<h2><span class="header-section-number">8.4</span> Singular Value Factorization</h2>
</div>
<div id="iterative-methods" class="section level2">
<h2><span class="header-section-number">8.5</span> Iterative Methods</h2>
</div>
<div id="solving-ols" class="section level2">
<h2><span class="header-section-number">8.6</span> Solving the OLS Problem</h2>
</div>
<div id="bibliographic-notes-6" class="section level2">
<h2><span class="header-section-number">8.7</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-6" class="section level2">
<h2><span class="header-section-number">8.8</span> Practice Yourself</h2>
<!--chapter:end:160-algebra.Rmd-->
</div>
</div>
<div id="convex" class="section level1">
<h1><span class="header-section-number">9</span> Convex Optimization</h1>
<div id="theoretical-backround" class="section level2">
<h2><span class="header-section-number">9.1</span> Theoretical Backround</h2>
</div>
<div id="optimizing-with-r" class="section level2">
<h2><span class="header-section-number">9.2</span> Optimizing with R</h2>
<div id="the-optim-function" class="section level3">
<h3><span class="header-section-number">9.2.1</span> The optim Function</h3>
</div>
<div id="the-nloptr-package" class="section level3">
<h3><span class="header-section-number">9.2.2</span> The nloptr Package</h3>
</div>
<div id="minqa-package" class="section level3">
<h3><span class="header-section-number">9.2.3</span> minqa Package</h3>
</div>
</div>
<div id="bibliographic-notes-7" class="section level2">
<h2><span class="header-section-number">9.3</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-7" class="section level2">
<h2><span class="header-section-number">9.4</span> Practice Yourself</h2>
<!--chapter:end:170-convex-optimization.Rmd-->
</div>
</div>
<div id="rcpp" class="section level1">
<h1><span class="header-section-number">10</span> RCpp</h1>
<div id="bibliographic-notes-8" class="section level2">
<h2><span class="header-section-number">10.1</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-8" class="section level2">
<h2><span class="header-section-number">10.2</span> Practice Yourself</h2>
<!--chapter:end:180-rcpp.Rmd-->
</div>
</div>
<div id="debugging" class="section level1">
<h1><span class="header-section-number">11</span> Debugging Tools</h1>
<div id="bibliographic-notes-9" class="section level2">
<h2><span class="header-section-number">11.1</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-9" class="section level2">
<h2><span class="header-section-number">11.2</span> Practice Yourself</h2>
<!--chapter:end:190-debugging.Rmd-->
</div>
</div>
<div id="basics" class="section level1">
<h1><span class="header-section-number">12</span> R Basics</h1>
<div id="other-ides" class="section level3">
<h3><span class="header-section-number">12.0.1</span> Other IDEs</h3>
</div>
<div id="file-types" class="section level2">
<h2><span class="header-section-number">12.1</span> File types</h2>
</div>
<div id="simple-calculator" class="section level2">
<h2><span class="header-section-number">12.2</span> Simple calculator</h2>
</div>
<div id="probability-calculator" class="section level2">
<h2><span class="header-section-number">12.3</span> Probability calculator</h2>
</div>
<div id="getting-help" class="section level2">
<h2><span class="header-section-number">12.4</span> Getting Help</h2>
</div>
<div id="variable-asignment" class="section level2">
<h2><span class="header-section-number">12.5</span> Variable Asignment</h2>
</div>
<div id="missing" class="section level2">
<h2><span class="header-section-number">12.6</span> Missing</h2>
</div>
<div id="piping" class="section level2">
<h2><span class="header-section-number">12.7</span> Piping</h2>
</div>
<div id="vector-creation-and-manipulation" class="section level2">
<h2><span class="header-section-number">12.8</span> Vector Creation and Manipulation</h2>
</div>
<div id="search-paths-and-packages" class="section level2">
<h2><span class="header-section-number">12.9</span> Search Paths and Packages</h2>
</div>
<div id="simple-plotting" class="section level2">
<h2><span class="header-section-number">12.10</span> Simple Plotting</h2>
</div>
<div id="object-types" class="section level2">
<h2><span class="header-section-number">12.11</span> Object Types</h2>
</div>
<div id="data-frames" class="section level2">
<h2><span class="header-section-number">12.12</span> Data Frames</h2>
</div>
<div id="exctraction" class="section level2">
<h2><span class="header-section-number">12.13</span> Exctraction</h2>
</div>
<div id="augmentations-of-the-data.frame-class" class="section level2">
<h2><span class="header-section-number">12.14</span> Augmentations of the data.frame class</h2>
</div>
<div id="data-import-and-export" class="section level2">
<h2><span class="header-section-number">12.15</span> Data Import and Export</h2>
<div id="import-from-web" class="section level3">
<h3><span class="header-section-number">12.15.1</span> Import from WEB</h3>
</div>
<div id="export-as-csv" class="section level3">
<h3><span class="header-section-number">12.15.2</span> Export as CSV</h3>
</div>
<div id="export-non-csv-files" class="section level3">
<h3><span class="header-section-number">12.15.3</span> Export non-CSV files</h3>
</div>
<div id="reading-from-text-files" class="section level3">
<h3><span class="header-section-number">12.15.4</span> Reading From Text Files</h3>
</div>
<div id="writing-data-to-text-files" class="section level3">
<h3><span class="header-section-number">12.15.5</span> Writing Data to Text Files</h3>
</div>
<div id="xlsx-files" class="section level3">
<h3><span class="header-section-number">12.15.6</span> .XLS(X) files</h3>
</div>
<div id="massive-files" class="section level3">
<h3><span class="header-section-number">12.15.7</span> Massive files</h3>
</div>
<div id="databases" class="section level3">
<h3><span class="header-section-number">12.15.8</span> Databases</h3>
</div>
</div>
<div id="functions" class="section level2">
<h2><span class="header-section-number">12.16</span> Functions</h2>
</div>
<div id="looping" class="section level2">
<h2><span class="header-section-number">12.17</span> Looping</h2>
</div>
<div id="apply" class="section level2">
<h2><span class="header-section-number">12.18</span> Apply</h2>
</div>
<div id="recursion" class="section level2">
<h2><span class="header-section-number">12.19</span> Recursion</h2>
</div>
<div id="dates-and-times" class="section level2">
<h2><span class="header-section-number">12.20</span> Dates and Times</h2>
</div>
<div id="bibliographic-notes-10" class="section level2">
<h2><span class="header-section-number">12.21</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-10" class="section level2">
<h2><span class="header-section-number">12.22</span> Practice Yourself</h2>
<!--chapter:end:20-r-basics.Rmd-->
</div>
</div>
<div id="econometrics" class="section level1">
<h1><span class="header-section-number">13</span> Econometrics</h1>
<div id="bibliographic-notes-11" class="section level2">
<h2><span class="header-section-number">13.1</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-11" class="section level2">
<h2><span class="header-section-number">13.2</span> Practice Yourself</h2>
<!--chapter:end:210-econometrics.Rmd-->
</div>
</div>
<div id="datatable" class="section level1">
<h1><span class="header-section-number">14</span> data.table</h1>
<div id="make-your-own-variables" class="section level2">
<h2><span class="header-section-number">14.1</span> Make your own variables</h2>
</div>
<div id="join" class="section level2">
<h2><span class="header-section-number">14.2</span> Join</h2>
</div>
<div id="reshaping-data" class="section level2">
<h2><span class="header-section-number">14.3</span> Reshaping data</h2>
<div id="wide-to-long" class="section level3">
<h3><span class="header-section-number">14.3.1</span> Wide to long</h3>
</div>
<div id="long-to-wide" class="section level3">
<h3><span class="header-section-number">14.3.2</span> Long to wide</h3>
</div>
</div>
<div id="bibliographic-notes-12" class="section level2">
<h2><span class="header-section-number">14.4</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-12" class="section level2">
<h2><span class="header-section-number">14.5</span> Practice Yourself</h2>
<!--chapter:end:21-datatable.Rmd-->
</div>
</div>
<div id="psychometrics" class="section level1">
<h1><span class="header-section-number">15</span> Psychometrics</h1>
<div id="bibliographic-notes-13" class="section level2">
<h2><span class="header-section-number">15.1</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-13" class="section level2">
<h2><span class="header-section-number">15.2</span> Practice Yourself</h2>
<!--chapter:end:220-psychometrics.Rmd-->
</div>
</div>
<div id="hadley" class="section level1">
<h1><span class="header-section-number">16</span> The Hadleyverse</h1>
<div id="readr" class="section level2">
<h2><span class="header-section-number">16.1</span> readr</h2>
</div>
<div id="dplyr" class="section level2">
<h2><span class="header-section-number">16.2</span> dplyr</h2>
</div>
<div id="tidyr" class="section level2">
<h2><span class="header-section-number">16.3</span> tidyr</h2>
</div>
<div id="reshape2" class="section level2">
<h2><span class="header-section-number">16.4</span> reshape2</h2>
</div>
<div id="stringr" class="section level2">
<h2><span class="header-section-number">16.5</span> stringr</h2>
</div>
<div id="anytime" class="section level2">
<h2><span class="header-section-number">16.6</span> anytime</h2>
</div>
<div id="biblipgraphic-notes" class="section level2">
<h2><span class="header-section-number">16.7</span> Biblipgraphic Notes</h2>
</div>
<div id="practice-yourself-14" class="section level2">
<h2><span class="header-section-number">16.8</span> Practice Yourself</h2>
<!--chapter:end:230-hadleyverse.Rmd-->
</div>
</div>
<div id="causality" class="section level1">
<h1><span class="header-section-number">17</span> Causal Inferense</h1>
<div id="causal-inference-from-designed-experiments" class="section level2">
<h2><span class="header-section-number">17.1</span> Causal Inference From Designed Experiments</h2>
<div id="design-of-experiments" class="section level3">
<h3><span class="header-section-number">17.1.1</span> Design of Experiments</h3>
</div>
<div id="randomized-inference" class="section level3">
<h3><span class="header-section-number">17.1.2</span> Randomized Inference</h3>
</div>
</div>
<div id="causal-inference-from-observational-data" class="section level2">
<h2><span class="header-section-number">17.2</span> Causal Inference from Observational Data</h2>
<div id="principal-stratification" class="section level3">
<h3><span class="header-section-number">17.2.1</span> Principal Stratification</h3>
</div>
<div id="instrumental-variables" class="section level3">
<h3><span class="header-section-number">17.2.2</span> Instrumental Variables</h3>
</div>
<div id="propensity-scores" class="section level3">
<h3><span class="header-section-number">17.2.3</span> Propensity Scores</h3>
</div>
<div id="direct-lieklihood" class="section level3">
<h3><span class="header-section-number">17.2.4</span> Direct Lieklihood</h3>
</div>
<div id="regression-discontinuity" class="section level3">
<h3><span class="header-section-number">17.2.5</span> Regression Discontinuity</h3>
</div>
</div>
<div id="bibliographic-notes-14" class="section level2">
<h2><span class="header-section-number">17.3</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-15" class="section level2">
<h2><span class="header-section-number">17.4</span> Practice Yourself</h2>
<!--chapter:end:280-causality.Rmd-->
</div>
</div>
<div id="eda" class="section level1">
<h1><span class="header-section-number">18</span> Exploratory Data Analysis</h1>
<p>Exploratory Data Analysis (EDA) is a term coined by <a href="https://en.wikipedia.org/wiki/John_Tukey">John W. Tukey</a> in his seminal book <span class="citation">(Tukey <a href="#ref-tukey1977exploratory">1977</a>)</span>. It is also (arguably) known as <em>Visual Analytics</em>, or <em>Descriptive Statistics</em>. It is the practice of inspecting, and exploring your data, before stating hypotheses, fitting predictors, and other more ambitious inferential goals. It typically includes the computation of simple <em>summary statistics</em> which capture some property of interest in the data, and <em>visualization</em>. EDA can be thought of as an assumption free, purely algorithmic practice.</p>
<p>In this text we present EDA techniques along the following lines:</p>
<ul>
<li>How we explore: with summary-statistics, or visually?</li>
<li>How many variables analyzed simultaneously: univariate, bivariate, or multivariate?</li>
<li>What type of variable: categorical or continuous?</li>
</ul>
<div id="summary-statistics" class="section level2">
<h2><span class="header-section-number">18.1</span> Summary Statistics</h2>
<div id="categorical-data" class="section level3">
<h3><span class="header-section-number">18.1.1</span> Categorical Data</h3>
<p>Categorical variables do not admit any mathematical operations on them. We cannot sum them, or even sort them. We can only <strong>count</strong> them. As such, summaries of categorical variables will always start with the counting of the frequency of each category.</p>
<div id="summary-of-univariate-categorical-data" class="section level4">
<h4><span class="header-section-number">18.1.1.1</span> Summary of Univariate Categorical Data</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Make some data</span></a>
<a class="sourceLine" id="cb1-2" title="2">gender &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;Boy&#39;</span>, <span class="dv">10</span>), <span class="kw">rep</span>(<span class="st">&#39;Girl&#39;</span>, <span class="dv">12</span>))</a>
<a class="sourceLine" id="cb1-3" title="3">drink &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;Coke&#39;</span>, <span class="dv">5</span>), <span class="kw">rep</span>(<span class="st">&#39;Sprite&#39;</span>, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="st">&#39;Coffee&#39;</span>, <span class="dv">6</span>), <span class="kw">rep</span>(<span class="st">&#39;Tea&#39;</span>, <span class="dv">7</span>), <span class="kw">rep</span>(<span class="st">&#39;Water&#39;</span>, <span class="dv">1</span>))  </a>
<a class="sourceLine" id="cb1-4" title="4">age &lt;-<span class="st">  </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&#39;Young&#39;</span>, <span class="st">&#39;Old&#39;</span>), <span class="dt">size =</span> <span class="kw">length</span>(gender), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co"># Count frequencies</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">table</span>(gender)</a></code></pre></div>
<pre><code>## gender
##  Boy Girl 
##   10   12</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">table</span>(drink)</a></code></pre></div>
<pre><code>## drink
## Coffee   Coke Sprite    Tea  Water 
##      6      5      3      7      1</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">table</span>(age)</a></code></pre></div>
<pre><code>## age
##   Old Young 
##     9    13</code></pre>
<p>If instead of the level counts you want the proportions, you can use <code>prop.table</code></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">prop.table</span>(<span class="kw">table</span>(gender))</a></code></pre></div>
<pre><code>## gender
##       Boy      Girl 
## 0.4545455 0.5454545</code></pre>
</div>
<div id="summary-of-bivariate-categorical-data" class="section level4">
<h4><span class="header-section-number">18.1.1.2</span> Summary of Bivariate Categorical Data</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">cbind</span>(gender, drink) <span class="op">%&gt;%</span><span class="st"> </span>head <span class="co"># bind vectors into matrix and inspect</span></a></code></pre></div>
<pre><code>##      gender drink   
## [1,] &quot;Boy&quot;  &quot;Coke&quot;  
## [2,] &quot;Boy&quot;  &quot;Coke&quot;  
## [3,] &quot;Boy&quot;  &quot;Coke&quot;  
## [4,] &quot;Boy&quot;  &quot;Coke&quot;  
## [5,] &quot;Boy&quot;  &quot;Coke&quot;  
## [6,] &quot;Boy&quot;  &quot;Sprite&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">table1 &lt;-<span class="st"> </span><span class="kw">table</span>(gender, drink) <span class="co"># count frequencies of bivariate combinations</span></a>
<a class="sourceLine" id="cb11-2" title="2">table1                                      </a></code></pre></div>
<pre><code>##       drink
## gender Coffee Coke Sprite Tea Water
##   Boy       2    5      3   0     0
##   Girl      4    0      0   7     1</code></pre>
</div>
<div id="summary-of-multivariate-categorical-data" class="section level4">
<h4><span class="header-section-number">18.1.1.3</span> Summary of Multivariate Categorical Data</h4>
<p>You may be wondering how does R handle tables with more than two dimensions. It is indeed not trivial to report this in a human-readable way. R offers several solutions: <code>table</code> is easier to compute with, and <code>ftable</code> is human readable.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">table2<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">table</span>(gender, drink, age) <span class="co"># A machine readable table. </span></a>
<a class="sourceLine" id="cb13-2" title="2">table2<span class="fl">.1</span></a></code></pre></div>
<pre><code>## , , age = Old
## 
##       drink
## gender Coffee Coke Sprite Tea Water
##   Boy       2    0      1   0     0
##   Girl      1    0      0   5     0
## 
## , , age = Young
## 
##       drink
## gender Coffee Coke Sprite Tea Water
##   Boy       0    5      2   0     0
##   Girl      3    0      0   2     1</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">table.<span class="fl">2.2</span> &lt;-<span class="st"> </span><span class="kw">ftable</span>(gender, drink, age) <span class="co"># A human readable table.</span></a>
<a class="sourceLine" id="cb15-2" title="2">table.<span class="fl">2.2</span></a></code></pre></div>
<pre><code>##               age Old Young
## gender drink               
## Boy    Coffee       2     0
##        Coke         0     5
##        Sprite       1     2
##        Tea          0     0
##        Water        0     0
## Girl   Coffee       1     3
##        Coke         0     0
##        Sprite       0     0
##        Tea          5     2
##        Water        0     1</code></pre>
<p>If you want proportions instead of counts, you need to specify the denominator, i.e., the margins. Think: what is the margin in each of the following outputs?</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">prop.table</span>(table1, <span class="dt">margin =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>##       drink
## gender     Coffee       Coke     Sprite        Tea      Water
##   Boy  0.20000000 0.50000000 0.30000000 0.00000000 0.00000000
##   Girl 0.33333333 0.00000000 0.00000000 0.58333333 0.08333333</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">prop.table</span>(table1, <span class="dt">margin =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##       drink
## gender    Coffee      Coke    Sprite       Tea     Water
##   Boy  0.3333333 1.0000000 1.0000000 0.0000000 0.0000000
##   Girl 0.6666667 0.0000000 0.0000000 1.0000000 1.0000000</code></pre>
</div>
</div>
<div id="continous-data" class="section level3">
<h3><span class="header-section-number">18.1.2</span> Continous Data</h3>
<p>Continuous variables admit many more operations than categorical. We can compute sums, means, quantiles, and more.</p>
<div id="summary-of-univariate-continuous-data" class="section level4">
<h4><span class="header-section-number">18.1.2.1</span> Summary of Univariate Continuous Data</h4>
<p>We distinguish between several types of summaries, each capturing a different property of the data.</p>
</div>
<div id="summary-of-location" class="section level4">
<h4><span class="header-section-number">18.1.2.2</span> Summary of Location</h4>
<p>Capture the “location” of the data. These include:</p>

<div class="definition">
<span id="def:unnamed-chunk-6" class="definition"><strong>(#def:unnamed-chunk-6) (Average)  </strong></span>The mean, or average, of a sample <span class="math inline">\(x:=(x_1,\dots,x_n)\)</span>, denoted <span class="math inline">\(\bar x\)</span> is defined as <span class="math display">\[ \bar x := n^{-1} \sum x_i. \]</span>
</div>

<p>The sample mean is <strong>non robust</strong>. A single large observation may inflate the mean indefinitely. For this reason, we define several other summaries of location, which are more robust, i.e., less affected by “contaminations” of the data.</p>
<p>We start by defining the sample quantiles, themselves <strong>not</strong> a summary of location.</p>

<div class="definition">
<span id="def:unnamed-chunk-7" class="definition"><strong>(#def:unnamed-chunk-7) (Quantiles)  </strong></span>The <span class="math inline">\(\alpha\)</span> quantile of a sample <span class="math inline">\(x\)</span>, denoted <span class="math inline">\(x_\alpha\)</span>, is (non uniquely) defined as a value above <span class="math inline">\(100 \alpha \%\)</span> of the sample, and below <span class="math inline">\(100 (1-\alpha) \%\)</span>.
</div>

<p>We emphasize that sample quantiles are non-uniquely defined. See <code>?quantile</code> for the 9(!) different definitions that R provides.</p>
<p>Using the sample quantiles, we can now define another summary of location, the <strong>median</strong>.</p>

<div class="definition">
<span id="def:unnamed-chunk-8" class="definition"><strong>(#def:unnamed-chunk-8) (Median)  </strong></span>The median of a sample <span class="math inline">\(x\)</span>, denoted <span class="math inline">\(x_{0.5}\)</span> is the <span class="math inline">\(\alpha=0.5\)</span> quantile of the sample.
</div>

<p>A whole family of summaries of locations is the <strong>alpha trimmed mean</strong>.</p>

<div class="definition">
<span id="def:unnamed-chunk-9" class="definition"><strong>(#def:unnamed-chunk-9) (Alpha Trimmed Mean)  </strong></span>The <span class="math inline">\(\alpha\)</span> trimmed mean of a sample <span class="math inline">\(x\)</span>, denoted <span class="math inline">\(\bar x_\alpha\)</span> is the average of the sample after removing the <span class="math inline">\(\alpha\)</span> proportion of largest and <span class="math inline">\(\alpha\)</span> proportion of smallest observations.
</div>

<p>The simple mean and median are instances of the alpha trimmed mean: <span class="math inline">\(\bar x_0\)</span> and <span class="math inline">\(\bar x_{0.5}\)</span> respectively.</p>
<p>Here are the R implementations:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">x &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">100</span>) <span class="co"># generate some random data</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">mean</span>(x) <span class="co"># simple mean</span></a></code></pre></div>
<pre><code>## [1] 0.8910823</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">median</span>(x) <span class="co"># median</span></a></code></pre></div>
<pre><code>## [1] 0.526393</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">mean</span>(x, <span class="dt">trim =</span> <span class="fl">0.2</span>) <span class="co"># alpha trimmed mean with alpha=0.2</span></a></code></pre></div>
<pre><code>## [1] 0.5981539</code></pre>
</div>
<div id="summary-of-scale" class="section level4">
<h4><span class="header-section-number">18.1.2.3</span> Summary of Scale</h4>
<p>The <em>scale</em> of the data, sometimes known as <em>spread</em>, can be thought of its variability.</p>

<div class="definition">
<span id="def:unnamed-chunk-11" class="definition"><strong>(#def:unnamed-chunk-11) (Standard Deviation)  </strong></span>The standard deviation of a sample <span class="math inline">\(x\)</span>, denoted <span class="math inline">\(S(x)\)</span>, is defined as <span class="math display">\[ S(x):=\sqrt{(n-1)^{-1} \sum (x_i-\bar x)^2} . \]</span>
</div>

<p>For reasons of robustness, we define other, more robust, measures of scale.</p>

<div class="definition">
<span id="def:unnamed-chunk-12" class="definition"><strong>(#def:unnamed-chunk-12) (MAD)  </strong></span>The Median Absolute Deviation from the median, denoted as <span class="math inline">\(MAD(x)\)</span>, is defined as <span class="math display">\[MAD(x):= c \: |x-x_{0.5}|_{0.5} . \]</span>
</div>

<p>where <span class="math inline">\(c\)</span> is some constant, typically set to <span class="math inline">\(c=1.4826\)</span> so that MAD and <span class="math inline">\(S(x)\)</span> have the same large sample limit.</p>

<div class="definition">
<span id="def:unnamed-chunk-13" class="definition"><strong>(#def:unnamed-chunk-13) (IQR)  </strong></span>The Inter Quantile Range of a sample <span class="math inline">\(x\)</span>, denoted as <span class="math inline">\(IQR(x)\)</span>, is defined as <span class="math display">\[ IQR(x):= x_{0.75}-x_{0.25} .\]</span>
</div>

<p>Here are the R implementations</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">sd</span>(x) <span class="co"># standard deviation</span></a></code></pre></div>
<pre><code>## [1] 1.045649</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">mad</span>(x) <span class="co"># MAD</span></a></code></pre></div>
<pre><code>## [1] 0.5021319</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">IQR</span>(x) <span class="co"># IQR</span></a></code></pre></div>
<pre><code>## [1] 0.8171068</code></pre>
</div>
<div id="summary-of-asymmetry" class="section level4">
<h4><span class="header-section-number">18.1.2.4</span> Summary of Asymmetry</h4>
<p>Summaries of asymmetry, also known as <em>skewness</em>, quantify the departure of the <span class="math inline">\(x\)</span> from a symmetric sample.</p>

<div class="definition">
<span id="def:unnamed-chunk-15" class="definition"><strong>(#def:unnamed-chunk-15) (Yule)  </strong></span>The Yule measure of assymetry, denoted <span class="math inline">\(Yule(x)\)</span> is defined as <span class="math display">\[Yule(x) := \frac{1/2 \: (x_{0.75}+x_{0.25}) - x_{0.5} }{1/2 \: IQR(x)} .\]</span>
</div>

<p>Here is an R implementation</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">yule &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb33-2" title="2">  numerator &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">quantile</span>(x,<span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span><span class="kw">quantile</span>(x,<span class="fl">0.25</span>))<span class="op">-</span><span class="kw">median</span>(x) </a>
<a class="sourceLine" id="cb33-3" title="3">  denominator &lt;-<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span><span class="st"> </span><span class="kw">IQR</span>(x)</a>
<a class="sourceLine" id="cb33-4" title="4">  <span class="kw">c</span>(numerator<span class="op">/</span>denominator, <span class="dt">use.names=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb33-5" title="5">}</a>
<a class="sourceLine" id="cb33-6" title="6"><span class="kw">yule</span>(x)</a></code></pre></div>
<pre><code>## [1] 0.3231963</code></pre>
</div>
<div id="summary-of-bivariate-continuous-data" class="section level4">
<h4><span class="header-section-number">18.1.2.5</span> Summary of Bivariate Continuous Data</h4>
<p>When dealing with bivariate, or multivariate data, we can obviously compute univariate summaries for each variable separately. This is not the topic of this section, in which we want to summarize the association <strong>between</strong> the variables, and not within them.</p>

<div class="definition">
<span id="def:unnamed-chunk-16" class="definition"><strong>(#def:unnamed-chunk-16) (Covariance)  </strong></span>The covariance between two samples, <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, of same length <span class="math inline">\(n\)</span>, is defined as <span class="math display">\[Cov(x,y):= (n-1)^{-1} \sum (x_i-\bar x)(y_i-\bar y)  \]</span>
</div>

<p>We emphasize this is not the covariance you learned about in probability classes, since it is not the covariance between two <em>random variables</em> but rather, between two <em>samples</em>. For this reasons, some authors call it the <em>empirical covariance</em>, or <em>sample covariance</em>.</p>

<div class="definition">
<span id="def:unnamed-chunk-17" class="definition"><strong>(#def:unnamed-chunk-17) (Pearson’s Correlation Coefficient)  </strong></span>Peasrson’s correlation coefficient, a.k.a. Pearson’s moment product correlation, or simply, the correlation, denoted <code>r(x,y)</code>, is defined as <span class="math display">\[r(x,y):=\frac{Cov(x,y)}{S(x)S(y)}. \]</span>
</div>

<p>If you find this definition enigmatic, just think of the correlation as the covariance between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> after transforming each to the unitless scale of z-scores.</p>

<div class="definition">
<span id="def:unnamed-chunk-18" class="definition"><strong>(#def:unnamed-chunk-18) (Z-Score)  </strong></span>The z-scores of a sample <span class="math inline">\(x\)</span> are defined as the mean-centered, scale normalized observations: <span class="math display">\[z_i(x):= \frac{x_i-\bar x}{S(x)}.\]</span>
</div>

<p>We thus have that <span class="math inline">\(r(x,y)=Cov(z(x),z(y))\)</span>.</p>
</div>
<div id="summary-of-multivariate-continuous-data" class="section level4">
<h4><span class="header-section-number">18.1.2.6</span> Summary of Multivariate Continuous Data</h4>
<p>The covariance is a simple summary of association between two variables, but it certainly may not capture the whole “story” when dealing with more than two variables. The most common summary of multivariate relation, is the <strong>covariance matrix</strong>, but we warn that only the simplest multivariate relations are fully summarized by this matrix.</p>

<div class="definition">
<span id="def:unnamed-chunk-19" class="definition"><strong>(#def:unnamed-chunk-19) (Sample Covariance Matrix)  </strong></span>Given <span class="math inline">\(n\)</span> observations on <span class="math inline">\(p\)</span> variables, denote <span class="math inline">\(x_{i,j}\)</span> the <span class="math inline">\(i\)</span>’th observation of the <span class="math inline">\(j\)</span>’th variable. The <em>sample covariance matrix</em>, denoted <span class="math inline">\(\hat \Sigma\)</span> is defined as <span class="math display">\[\hat \Sigma_{k,l}=(n-1)^{-1} \sum_i [(x_{i,k}-\bar x_k)(x_{i,l}-\bar x_l)],\]</span> where <span class="math inline">\(\bar x_k:=n^{-1} \sum_i x_{i,k}\)</span>. Put differently, the <span class="math inline">\(k,l\)</span>’th entry in <span class="math inline">\(\hat \Sigma\)</span> is the sample covariance between variables <span class="math inline">\(k\)</span> and <span class="math inline">\(l\)</span>.
</div>


<div class="remark">
 <span class="remark"><em>Remark. </em></span> <span class="math inline">\(\hat \Sigma\)</span> is clearly non robust. How would you define a robust covariance matrix?
</div>

</div>
</div>
</div>
<div id="visualization" class="section level2">
<h2><span class="header-section-number">18.2</span> Visualization</h2>
<p>Summarizing the information in a variable to a single number clearly conceals much of the story in the sample. This is akin to inspecting a person using a caricature, instead of a picture. Visualizing the data, when possible, is more informative.</p>
<div id="categorical-data-1" class="section level3">
<h3><span class="header-section-number">18.2.1</span> Categorical Data</h3>
<p>Recalling that with categorical variables we can only count the frequency of each level, the plotting of such variables are typically variations on the <em>bar plot</em>.</p>
<div id="visualizing-univariate-categorical-data" class="section level4">
<h4><span class="header-section-number">18.2.1.1</span> Visualizing Univariate Categorical Data</h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">barplot</span>(<span class="kw">table</span>(age))</a></code></pre></div>
<p><img src="Rcourse_files/figure-html/barplot-1.png" width="672" /></p>
</div>
<div id="visualizing-bivariate-categorical-data" class="section level4">
<h4><span class="header-section-number">18.2.1.2</span> Visualizing Bivariate Categorical Data</h4>
<p>There are several generalizations of the barplot, aimed to deal with the visualization of bivariate categorical data. They are sometimes known as the <em>clustered bar plot</em> and the <em>stacked bar plot</em>. In this text, we advocate the use of the <em>mosaic plot</em> which is also the default in R.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">plot</span>(table1, <span class="dt">main=</span><span class="st">&#39;Bivariate mosaic plot&#39;</span>)</a></code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="visualizing-multivariate-categorical-data" class="section level4">
<h4><span class="header-section-number">18.2.1.3</span> Visualizing Multivariate Categorical Data</h4>
<p>The <em>mosaic plot</em> is not easy to generalize to more than two variables, but it is still possible (at the cost of interpretability).</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">plot</span>(table2<span class="fl">.1</span>, <span class="dt">main=</span><span class="st">&#39;Trivaraite mosaic plot&#39;</span>)</a></code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
</div>
<div id="continuous-data" class="section level3">
<h3><span class="header-section-number">18.2.2</span> Continuous Data</h3>
<div id="visualizing-univariate-continuous-data" class="section level4">
<h4><span class="header-section-number">18.2.2.1</span> Visualizing Univariate Continuous Data</h4>
<p>Unlike categorical variables, there are endlessly many way to visualize continuous variables. The simplest way is to look at the raw data via the <code>stripchart</code>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">sample1 &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">10</span>)                             </a>
<a class="sourceLine" id="cb38-2" title="2"><span class="kw">stripchart</span>(sample1)</a></code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Clearly, if there are many observations, the <code>stripchart</code> will be a useless line of black dots. We thus bin them together, and look at the frequency of each bin; this is the <em>histogram</em>. R’s <code>histogram</code> function has very good defaults to choose the number of bins. Here is a histogram showing the counts of each bin.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">sample1 &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">100</span>)                            </a>
<a class="sourceLine" id="cb39-2" title="2"><span class="kw">hist</span>(sample1, <span class="dt">freq=</span>T, <span class="dt">main=</span><span class="st">&#39;Counts&#39;</span>)        </a></code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>The bin counts can be replaced with the proportion of each bin using the <code>freq</code> argument.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">hist</span>(sample1, <span class="dt">freq=</span>F, <span class="dt">main=</span><span class="st">&#39;Proportion&#39;</span>)    </a></code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>The bins of a histogram are non overlapping. We can adopt a sliding window approach, instead of binning. This is the <em>density plot</em> which is produced with the <code>density</code> function, and added to an existing plot with the <code>lines</code> function. The <code>rug</code> function adds the original data points as ticks on the axes, and is strongly recommended to detect artifacts introduced by the binning of the histogram, or the smoothing of the density plot.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">hist</span>(sample1, <span class="dt">freq=</span>F, <span class="dt">main=</span><span class="st">&#39;Frequencies&#39;</span>)   </a>
<a class="sourceLine" id="cb41-2" title="2"><span class="kw">lines</span>(<span class="kw">density</span>(sample1))                     </a>
<a class="sourceLine" id="cb41-3" title="3"><span class="kw">rug</span>(sample1)</a></code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>

<div class="remark">
 <span class="remark"><em>Remark. </em></span> Why would it make no sense to make a table, or a barplot, of continuous data?
</div>

<p>One particularly useful visualization, due to John W. Tukey, is the <em>boxplot</em>. The boxplot is designed to capture the main phenomena in the data, and simultaneously point to outlines.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">boxplot</span>(sample1)    </a></code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="visualizing-bivariate-continuous-data" class="section level4">
<h4><span class="header-section-number">18.2.2.2</span> Visualizing Bivariate Continuous Data</h4>
<p>The bivariate counterpart of the <code>stipchart</code> is the celebrated scatter plot.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb43-2" title="2">x1 &lt;-<span class="st"> </span><span class="kw">rexp</span>(n)</a>
<a class="sourceLine" id="cb43-3" title="3">x2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="kw">rexp</span>(n)</a>
<a class="sourceLine" id="cb43-4" title="4"><span class="kw">plot</span>(x2<span class="op">~</span>x1)</a></code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Like the univariate <code>stripchart</code>, the scatter plot will be an uninformative mess in the presence of a lot of data. A nice bivariate counterpart of the univariate histogram is the <em>hexbin plot</em>, which tessellates the plane with hexagons, and reports their frequencies.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">library</span>(hexbin) <span class="co"># load required library</span></a>
<a class="sourceLine" id="cb44-2" title="2">n &lt;-<span class="st"> </span><span class="fl">2e5</span></a>
<a class="sourceLine" id="cb44-3" title="3">x1 &lt;-<span class="st"> </span><span class="kw">rexp</span>(n)</a>
<a class="sourceLine" id="cb44-4" title="4">x2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb44-5" title="5"><span class="kw">plot</span>(<span class="kw">hexbin</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2))</a></code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="visualizing-multivariate-continuous-data" class="section level4">
<h4><span class="header-section-number">18.2.2.3</span> Visualizing Multivariate Continuous Data</h4>
<p>Visualizing multivariate data is a tremendous challenge given that we cannot grasp <span class="math inline">\(4\)</span> dimensional spaces, nor can the computer screen present more than <span class="math inline">\(2\)</span> dimensional spaces. We thus have several options: (i) To project the data to 2D. This is discussed in the Dimensionality Reduction Section @ref(dim-reduce). (ii) To visualize not the raw data, but rather its summaries, like the covariance matrix.</p>
<p>Since the covariance matrix, <span class="math inline">\(\hat \Sigma\)</span> is a matrix, it can be visualized as an image. Note the use of the <code>::</code> operator, which is used to call a function from some package, without loading the whole package. We will use the <code>::</code> operator when we want to emphasize the package of origin of a function.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">covariance &lt;-<span class="st"> </span><span class="kw">cov</span>(longley) <span class="co"># The covariance of the longley dataset</span></a>
<a class="sourceLine" id="cb45-2" title="2">correlations &lt;-<span class="st"> </span><span class="kw">cor</span>(longley) <span class="co"># The correlations of the longley dataset</span></a>
<a class="sourceLine" id="cb45-3" title="3">lattice<span class="op">::</span><span class="kw">levelplot</span>(correlations)</a></code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>If we believe the covariance has some structure, we can do better then viewing the raw correlations. In temporal, and spatial data, we belive correlations decay as some function of distances. We can thus view correlations as a function of the distnace between observations. This is known as a <em>variogram</em>. Note that for a variogram to be informative, is it implied that correlations are merely a function of distances (and not locations themselves). This is formally known as <em>stationary</em> and <em>isotropic</em> correlations.</p>
<div class="figure">
<img src="art/variogram.png" alt="Variogram: plotting correlation as a function of spatial distance. Courtesy of Ron Sarafian." />
<p class="caption">Variogram: plotting correlation as a function of spatial distance. Courtesy of Ron Sarafian.</p>
</div>
</div>
<div id="parcoord" class="section level4">
<h4><span class="header-section-number">18.2.2.4</span> Parallel Coordinate Plots</h4>
<p>TODO</p>
</div>
</div>
</div>
<div id="mixed-type-data" class="section level2">
<h2><span class="header-section-number">18.3</span> Mixed Type Data</h2>
<p>Most real data sets will be of mixed type: both categorical and continous. One approach to view such data, is to visualize the continous variables separatly, for each level of the categorical variables. There are, however, interesting dedicated visualization for such data.</p>
<div id="alluvian-diagram" class="section level3">
<h3><span class="header-section-number">18.3.1</span> Alluvian Diagram</h3>
<p>An Alluvian plot is a type of <a href="#parcoord">Parallel Coordinate Plot</a> for multivariate categorical data. It is particularly interesting when the <span class="math inline">\(x\)</span> axis is a discretized time variable, and it is used to visualize flow.</p>
<p>The following example, from the <strong>ggalluvial</strong> package Vignette by <a href="https://cran.r-project.org/web/packages/ggalluvial/vignettes/ggalluvial.html">Jason Cory Brunson</a>, demonstrates the flow of students between different majors, as semesters evolve.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">library</span>(ggalluvial)</a></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">data</span>(majors)</a>
<a class="sourceLine" id="cb48-2" title="2">majors<span class="op">$</span>curriculum &lt;-<span class="st"> </span><span class="kw">as.factor</span>(majors<span class="op">$</span>curriculum)</a>
<a class="sourceLine" id="cb48-3" title="3"><span class="kw">ggplot</span>(majors,</a>
<a class="sourceLine" id="cb48-4" title="4">       <span class="kw">aes</span>(<span class="dt">x =</span> semester, <span class="dt">stratum =</span> curriculum, <span class="dt">alluvium =</span> student,</a>
<a class="sourceLine" id="cb48-5" title="5">           <span class="dt">fill =</span> curriculum, <span class="dt">label =</span> curriculum)) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-7" title="7"><span class="st">  </span><span class="kw">geom_flow</span>(<span class="dt">stat =</span> <span class="st">&quot;alluvium&quot;</span>, <span class="dt">lode.guidance =</span> <span class="st">&quot;rightleft&quot;</span>,</a>
<a class="sourceLine" id="cb48-8" title="8">            <span class="dt">color =</span> <span class="st">&quot;darkgray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-9" title="9"><span class="st">  </span><span class="kw">geom_stratum</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb48-10" title="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-11" title="11"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;student curricula across several semesters&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Prefixing `UQ()` with the rlang namespace is deprecated as of rlang 0.3.0.
## Please use the non-prefixed form or `!!` instead.
## 
##   # Bad:
##   rlang::expr(mean(rlang::UQ(var) * 100))
## 
##   # Ok:
##   rlang::expr(mean(UQ(var) * 100))
## 
##   # Good:
##   rlang::expr(mean(!!var * 100))
## 
## This warning is displayed once per session.</code></pre>
<pre><code>## Warning: Computation failed in `stat_alluvium()`:
## Evaluation error: `as_dictionary()` is defunct as of rlang 0.3.0.
## Please use `as_data_pronoun()` instead.</code></pre>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>Things to note:</p>
<ul>
<li>We used the <strong>galluvian</strong> package of the <strong>ggplot2</strong> ecosystem. More on <strong>ggplot2</strong> in the <a href="#plotting">Plotting Chapter</a>.</li>
<li>Time is on the <span class="math inline">\(x\)</span> axis. Categories are color coded.</li>
</ul>
</div>
</div>
<div id="bibliographic-notes-15" class="section level2">
<h2><span class="header-section-number">18.4</span> Bibliographic Notes</h2>
<p>Like any other topic in this book, you can consult <span class="citation">Venables and Ripley (<a href="#ref-venables2013modern">2013</a>)</span>. The seminal book on EDA, written long before R was around, is <span class="citation">Tukey (<a href="#ref-tukey1977exploratory">1977</a>)</span>. For an excellent text on robust statistics see <span class="citation">Wilcox (<a href="#ref-wilcox2011introduction">2011</a>)</span>.</p>
</div>
<div id="practice-yourself-16" class="section level2">
<h2><span class="header-section-number">18.5</span> Practice Yourself</h2>
<ol style="list-style-type: decimal">
<li><p>Read about the Titanic data set using <code>?Titanic</code>. Inspect it with the <code>table</code> and with the <code>ftable</code> commands. Which do you prefer?</p></li>
<li><p>Inspect the Titanic data with a plot. Start with <code>plot(Titanic)</code> Try also <code>lattice::dotplot</code>. Which is the passenger category with most survivors? Which plot do you prefer? Which scales better to more categories?</p></li>
<li>Read about the women data using <code>?women</code>.
<ol style="list-style-type: decimal">
<li>Compute the average of each variable. What is the average of the heights?</li>
<li>Plot a histogram of the heights. Add ticks using <code>rug</code>.</li>
<li>Plot a boxplot of the weights.</li>
<li>Plot the heights and weights using a scatter plot. Add ticks using <code>rug</code>.</li>
</ol></li>
<li><p>Choose <span class="math inline">\(\alpha\)</span> to define a new symmetry measure: <span class="math inline">\(1/2(x_\alpha+x_{1-\alpha})-x_{0.5}\)</span>. Write a function that computes it, and apply it on women’s heights data.</p></li>
<li><p>Compute the covariance matrix of women’s heights and weights. Compute the correlation matrix. View the correlation matrix as an image using <code>lattice::levelplot</code>.</p></li>
<li><p>Pick a dataset with two LONG continous variables from <code>?datasets</code>. Plot it using <code>hexbin::hexbin</code>.</p></li>
</ol>
<!--chapter:end:30-eda.Rmd-->
</div>
</div>
<div id="lm" class="section level1">
<h1><span class="header-section-number">19</span> Linear Models</h1>
<div id="problem-setup" class="section level2">
<h2><span class="header-section-number">19.1</span> Problem Setup</h2>
</div>
<div id="ols-estimation-in-r" class="section level2">
<h2><span class="header-section-number">19.2</span> OLS Estimation in R</h2>
</div>
<div id="inference" class="section level2">
<h2><span class="header-section-number">19.3</span> Inference</h2>
<div id="testing-a-hypothesis-on-a-single-coefficient" class="section level3">
<h3><span class="header-section-number">19.3.1</span> Testing a Hypothesis on a Single Coefficient</h3>
</div>
<div id="constructing-a-confidence-interval-on-a-single-coefficient" class="section level3">
<h3><span class="header-section-number">19.3.2</span> Constructing a Confidence Interval on a Single Coefficient</h3>
</div>
<div id="multiple-regression" class="section level3">
<h3><span class="header-section-number">19.3.3</span> Multiple Regression</h3>
</div>
<div id="anova-testing-a-hypothesis-on-a-single-contrast" class="section level3">
<h3><span class="header-section-number">19.3.4</span> ANOVA (<em>) ### Testing a Hypothesis on a Single Contrast (</em>)</h3>
</div>
</div>
<div id="bibliographic-notes-16" class="section level2">
<h2><span class="header-section-number">19.4</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-17" class="section level2">
<h2><span class="header-section-number">19.5</span> Practice Yourself</h2>
<!--chapter:end:40-lm.Rmd-->
</div>
</div>
<div id="glm" class="section level1">
<h1><span class="header-section-number">20</span> Generalized Linear Models</h1>
<div id="problem-setup-1" class="section level2">
<h2><span class="header-section-number">20.1</span> Problem Setup</h2>
</div>
<div id="logistic-regression" class="section level2">
<h2><span class="header-section-number">20.2</span> Logistic Regression</h2>
<div id="logistic-regression-with-r" class="section level3">
<h3><span class="header-section-number">20.2.1</span> Logistic Regression with R</h3>
</div>
</div>
<div id="poisson-regression" class="section level2">
<h2><span class="header-section-number">20.3</span> Poisson Regression</h2>
</div>
<div id="extensions" class="section level2">
<h2><span class="header-section-number">20.4</span> Extensions</h2>
</div>
<div id="bibliographic-notes-17" class="section level2">
<h2><span class="header-section-number">20.5</span> Bibliographic Notes</h2>
</div>
<div id="practice-glm" class="section level2">
<h2><span class="header-section-number">20.6</span> Practice Yourself</h2>
<!--chapter:end:50-glm.Rmd-->
</div>
</div>
<div id="lme" class="section level1">
<h1><span class="header-section-number">21</span> Linear Mixed Models</h1>
<div id="problem-setup-2" class="section level2">
<h2><span class="header-section-number">21.1</span> Problem Setup</h2>
<div id="non-linear-mixed-models" class="section level3">
<h3><span class="header-section-number">21.1.1</span> Non-Linear Mixed Models</h3>
</div>
<div id="generalized-linear-mixed-models-glmm" class="section level3">
<h3><span class="header-section-number">21.1.2</span> Generalized Linear Mixed Models (GLMM)</h3>
</div>
</div>
<div id="mixed-models-with-r" class="section level2">
<h2><span class="header-section-number">21.2</span> Mixed Models with R</h2>
<div id="a-single-random-effect" class="section level3">
<h3><span class="header-section-number">21.2.1</span> A Single Random Effect</h3>
</div>
<div id="multiple-random-effects" class="section level3">
<h3><span class="header-section-number">21.2.2</span> Multiple Random Effects</h3>
</div>
<div id="a-full-mixed-model" class="section level3">
<h3><span class="header-section-number">21.2.3</span> A Full Mixed-Model</h3>
</div>
</div>
<div id="serial" class="section level2">
<h2><span class="header-section-number">21.3</span> Serial Correlations</h2>
</div>
<div id="extensions-1" class="section level2">
<h2><span class="header-section-number">21.4</span> Extensions</h2>
<div id="cluster-robust-standard-errors" class="section level3">
<h3><span class="header-section-number">21.4.1</span> Cluster Robust Standard Errors</h3>
</div>
<div id="linear-models-for-panel-data" class="section level3">
<h3><span class="header-section-number">21.4.2</span> Linear Models for Panel Data</h3>
</div>
<div id="testing-hypotheses-on-correlations" class="section level3">
<h3><span class="header-section-number">21.4.3</span> Testing Hypotheses on Correlations</h3>
</div>
</div>
<div id="relation-to-other-estimators" class="section level2">
<h2><span class="header-section-number">21.5</span> Relation to Other Estimators</h2>
<div id="fixed-effects-in-the-econometric-literature" class="section level3">
<h3><span class="header-section-number">21.5.1</span> Fixed Effects in the Econometric Literature</h3>
</div>
<div id="relation-to-generalized-least-squares-gls" class="section level3">
<h3><span class="header-section-number">21.5.2</span> Relation to Generalized Least Squares (GLS)</h3>
</div>
<div id="relation-to-conditional-gaussian-fields" class="section level3">
<h3><span class="header-section-number">21.5.3</span> Relation to Conditional Gaussian Fields</h3>
</div>
<div id="relation-to-empirical-risk-minimization-erm" class="section level3">
<h3><span class="header-section-number">21.5.4</span> Relation to Empirical Risk Minimization (ERM)</h3>
</div>
<div id="relation-to-m-estimation" class="section level3">
<h3><span class="header-section-number">21.5.5</span> Relation to M-Estimation</h3>
</div>
<div id="relation-to-generalize-estimating-equations-gee" class="section level3">
<h3><span class="header-section-number">21.5.6</span> Relation to Generalize Estimating Equations (GEE)</h3>
</div>
<div id="manova" class="section level3">
<h3><span class="header-section-number">21.5.7</span> Relation to MANOVA</h3>
</div>
<div id="relation-to-seemingly-unrelated-equations-sur" class="section level3">
<h3><span class="header-section-number">21.5.8</span> Relation to Seemingly Unrelated Equations (SUR)</h3>
</div>
</div>
<div id="the-variance-components-view" class="section level2">
<h2><span class="header-section-number">21.6</span> The Variance-Components View</h2>
</div>
<div id="bibliographic-notes-18" class="section level2">
<h2><span class="header-section-number">21.7</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-18" class="section level2">
<h2><span class="header-section-number">21.8</span> Practice Yourself</h2>
<!--chapter:end:60-lme.Rmd-->
</div>
</div>
<div id="multivariate" class="section level1">
<h1><span class="header-section-number">22</span> Multivariate Data Analysis</h1>
<div id="signal-detection" class="section level2">
<h2><span class="header-section-number">22.1</span> Signal Detection</h2>
<div id="hotellings-t2-test" class="section level3">
<h3><span class="header-section-number">22.1.1</span> Hotelling’s T2 Test</h3>
</div>
<div id="various-types-of-signal-to-detect" class="section level3">
<h3><span class="header-section-number">22.1.2</span> Various Types of Signal to Detect</h3>
</div>
<div id="simes-test" class="section level3">
<h3><span class="header-section-number">22.1.3</span> Simes’ Test</h3>
</div>
<div id="signal-detection-with-r" class="section level3">
<h3><span class="header-section-number">22.1.4</span> Signal Detection with R</h3>
</div>
</div>
<div id="signal-counting" class="section level2">
<h2><span class="header-section-number">22.2</span> Signal Counting</h2>
</div>
<div id="identification" class="section level2">
<h2><span class="header-section-number">22.3</span> Signal Identification</h2>
<div id="signal-identification-in-r" class="section level3">
<h3><span class="header-section-number">22.3.1</span> Signal Identification in R</h3>
</div>
</div>
<div id="signal-estimation-multivariate-regression" class="section level2">
<h2><span class="header-section-number">22.4</span> Signal Estimation (<em>) ## Multivariate Regression (</em>)</h2>
<div id="multivariate-regression-with-r" class="section level3">
<h3><span class="header-section-number">22.4.1</span> Multivariate Regression with R</h3>
</div>
</div>
<div id="graphical-models-graphical-models-in-r-biblipgraphic-notes-practice-yourself" class="section level2">
<h2><span class="header-section-number">22.5</span> Graphical Models (*) ### Graphical Models in R ## Biblipgraphic Notes ## Practice Yourself</h2>
<!--chapter:end:70-multivariate.Rmd-->
</div>
</div>
<div id="supervised" class="section level1">
<h1><span class="header-section-number">23</span> Supervised Learning</h1>
<div id="problem-setup-3" class="section level2">
<h2><span class="header-section-number">23.1</span> Problem Setup</h2>
<div id="common-hypothesis-classes" class="section level3">
<h3><span class="header-section-number">23.1.1</span> Common Hypothesis Classes</h3>
</div>
<div id="common-complexity-penalties" class="section level3">
<h3><span class="header-section-number">23.1.2</span> Common Complexity Penalties</h3>
</div>
<div id="unbiased-risk-estimation" class="section level3">
<h3><span class="header-section-number">23.1.3</span> Unbiased Risk Estimation</h3>
</div>
<div id="collecting-the-pieces" class="section level3">
<h3><span class="header-section-number">23.1.4</span> Collecting the Pieces</h3>
</div>
</div>
<div id="supervised-learning-in-r" class="section level2">
<h2><span class="header-section-number">23.2</span> Supervised Learning in R</h2>
<div id="least-squares" class="section level3">
<h3><span class="header-section-number">23.2.1</span> Linear Models with Least Squares Loss</h3>
</div>
<div id="svm" class="section level3">
<h3><span class="header-section-number">23.2.2</span> SVM</h3>
</div>
<div id="neural-nets" class="section level3">
<h3><span class="header-section-number">23.2.3</span> Neural Nets</h3>
<div id="deep-nets" class="section level4">
<h4><span class="header-section-number">23.2.3.1</span> Deep Nets</h4>
</div>
</div>
<div id="classification-and-regression-trees-cart" class="section level3">
<h3><span class="header-section-number">23.2.4</span> Classification and Regression Trees (CART)</h3>
<div id="the-rpart-package" class="section level4">
<h4><span class="header-section-number">23.2.4.1</span> The rpart Package</h4>
</div>
<div id="the-caret-package" class="section level4">
<h4><span class="header-section-number">23.2.4.2</span> The caret Package</h4>
</div>
</div>
<div id="k-nearest-neighbour-knn" class="section level3">
<h3><span class="header-section-number">23.2.5</span> K-nearest neighbour (KNN)</h3>
</div>
<div id="linear-discriminant-analysis-lda" class="section level3">
<h3><span class="header-section-number">23.2.6</span> Linear Discriminant Analysis (LDA)</h3>
</div>
<div id="naive-bayes" class="section level3">
<h3><span class="header-section-number">23.2.7</span> Naive Bayes</h3>
</div>
<div id="random-forrest" class="section level3">
<h3><span class="header-section-number">23.2.8</span> Random Forrest</h3>
<div id="the-randomforest-package" class="section level4">
<h4><span class="header-section-number">23.2.8.1</span> The randomForest Package</h4>
</div>
<div id="the-ranger-package" class="section level4">
<h4><span class="header-section-number">23.2.8.2</span> The ranger Package</h4>
</div>
</div>
<div id="gradient-boosting" class="section level3">
<h3><span class="header-section-number">23.2.9</span> Gradient Boosting</h3>
<div id="the-gbm-package" class="section level4">
<h4><span class="header-section-number">23.2.9.1</span> The gbm Package</h4>
</div>
<div id="the-xgboost-package" class="section level4">
<h4><span class="header-section-number">23.2.9.2</span> The xgboost Package</h4>
</div>
</div>
</div>
<div id="bibliographic-notes-19" class="section level2">
<h2><span class="header-section-number">23.3</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-19" class="section level2">
<h2><span class="header-section-number">23.4</span> Practice Yourself</h2>
<!--chapter:end:80-supervised.Rmd-->
</div>
</div>
<div id="unsupervised" class="section level1">
<h1><span class="header-section-number">24</span> Unsupervised Learning</h1>
<div id="dim-reduce" class="section level2">
<h2><span class="header-section-number">24.1</span> Dimensionality Reduction</h2>
<div id="pca" class="section level3">
<h3><span class="header-section-number">24.1.1</span> Principal Component Analysis</h3>
<div id="mathematics-of-pca" class="section level4">
<h4><span class="header-section-number">24.1.1.1</span> Mathematics of PCA</h4>
</div>
<div id="how-hard-is-the-pca-problem" class="section level4">
<h4><span class="header-section-number">24.1.1.2</span> How Hard is the PCA Problem?</h4>
</div>
</div>
<div id="dimensionality-reduction-preliminaries" class="section level3">
<h3><span class="header-section-number">24.1.2</span> Dimensionality Reduction Preliminaries</h3>
</div>
<div id="latent-variable-generative-approaches" class="section level3">
<h3><span class="header-section-number">24.1.3</span> Latent Variable Generative Approaches</h3>
<div id="factor-analysis-fa" class="section level4">
<h4><span class="header-section-number">24.1.3.1</span> Factor Analysis (FA)</h4>
</div>
<div id="independent-component-analysis-ica" class="section level4">
<h4><span class="header-section-number">24.1.3.2</span> Independent Component Analysis (ICA)</h4>
</div>
</div>
<div id="purely-algorithmic-approaches" class="section level3">
<h3><span class="header-section-number">24.1.4</span> Purely Algorithmic Approaches</h3>
<div id="multidimensional-scaling-mds" class="section level4">
<h4><span class="header-section-number">24.1.4.1</span> Multidimensional Scaling (MDS)</h4>
</div>
<div id="local-multidimensional-scaling-local-mds" class="section level4">
<h4><span class="header-section-number">24.1.4.2</span> Local Multidimensional Scaling (Local MDS)</h4>
</div>
<div id="isomap" class="section level4">
<h4><span class="header-section-number">24.1.4.3</span> Isometric Feature Mapping (IsoMap)</h4>
</div>
<div id="local-linear-embedding-lle" class="section level4">
<h4><span class="header-section-number">24.1.4.4</span> Local Linear Embedding (LLE)</h4>
</div>
<div id="kernel-pca-kpca" class="section level4">
<h4><span class="header-section-number">24.1.4.5</span> Kernel PCA (kPCA)</h4>
</div>
<div id="sparse-pca-spca" class="section level4">
<h4><span class="header-section-number">24.1.4.6</span> Sparse PCA (sPCA)</h4>
</div>
<div id="sparse-kernel-pca-skpca" class="section level4">
<h4><span class="header-section-number">24.1.4.7</span> Sparse kernel PCA (skPCA)</h4>
</div>
<div id="correspondence-analysis-ca" class="section level4">
<h4><span class="header-section-number">24.1.4.8</span> Correspondence Analysis (CA)</h4>
</div>
</div>
<div id="dimensionality-reduction-in-r" class="section level3">
<h3><span class="header-section-number">24.1.5</span> Dimensionality Reduction in R</h3>
<div id="pca-in-r" class="section level4">
<h4><span class="header-section-number">24.1.5.1</span> PCA</h4>
</div>
<div id="fa" class="section level4">
<h4><span class="header-section-number">24.1.5.2</span> FA</h4>
</div>
<div id="ica" class="section level4">
<h4><span class="header-section-number">24.1.5.3</span> ICA</h4>
</div>
<div id="mds" class="section level4">
<h4><span class="header-section-number">24.1.5.4</span> MDS</h4>
</div>
<div id="sparse-pca" class="section level4">
<h4><span class="header-section-number">24.1.5.5</span> Sparse PCA</h4>
</div>
<div id="kernel-pca" class="section level4">
<h4><span class="header-section-number">24.1.5.6</span> Kernel PCA</h4>
</div>
<div id="mca" class="section level4">
<h4><span class="header-section-number">24.1.5.7</span> MCA</h4>
</div>
</div>
</div>
<div id="cluster" class="section level2">
<h2><span class="header-section-number">24.2</span> Clustering</h2>
<div id="latent-variable-generative-approaches-1" class="section level3">
<h3><span class="header-section-number">24.2.1</span> Latent Variable Generative Approaches</h3>
<div id="finite-mixture" class="section level4">
<h4><span class="header-section-number">24.2.1.1</span> Finite Mixture</h4>
</div>
</div>
<div id="purely-algorithmic-approaches-1" class="section level3">
<h3><span class="header-section-number">24.2.2</span> Purely Algorithmic Approaches</h3>
<div id="k-means" class="section level4">
<h4><span class="header-section-number">24.2.2.1</span> K-Means</h4>
</div>
<div id="k-means-1" class="section level4">
<h4><span class="header-section-number">24.2.2.2</span> K-Means++</h4>
</div>
<div id="k-medoids" class="section level4">
<h4><span class="header-section-number">24.2.2.3</span> K-Medoids</h4>
</div>
<div id="hirarchial-clustering" class="section level4">
<h4><span class="header-section-number">24.2.2.4</span> Hirarchial Clustering</h4>
</div>
<div id="fuzzy-clustering" class="section level4">
<h4><span class="header-section-number">24.2.2.5</span> Fuzzy Clustering</h4>
</div>
</div>
<div id="clustering-in-r" class="section level3">
<h3><span class="header-section-number">24.2.3</span> Clustering in R</h3>
<div id="k-means-2" class="section level4">
<h4><span class="header-section-number">24.2.3.1</span> K-Means</h4>
</div>
<div id="k-means-3" class="section level4">
<h4><span class="header-section-number">24.2.3.2</span> K-Means ++</h4>
</div>
<div id="k-medoids-1" class="section level4">
<h4><span class="header-section-number">24.2.3.3</span> K-Medoids</h4>
</div>
<div id="hirarchial-clustering-1" class="section level4">
<h4><span class="header-section-number">24.2.3.4</span> Hirarchial Clustering</h4>
</div>
</div>
</div>
<div id="bibliographic-notes-20" class="section level2">
<h2><span class="header-section-number">24.3</span> Bibliographic Notes</h2>
</div>
<div id="practice-yourself-20" class="section level2">
<h2><span class="header-section-number">24.4</span> Practice Yourself</h2>
<!--chapter:end:90-unsupervised.Rmd-->
<div id="refs" class="references">
<div id="ref-tukey1977exploratory">
<p>Tukey, John W. 1977. <em>Exploratory Data Analysis</em>. Reading, Mass.</p>
</div>
<div id="ref-venables2013modern">
<p>Venables, William N, and Brian D Ripley. 2013. <em>Modern Applied Statistics with S-Plus</em>. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-wilcox2011introduction">
<p>Wilcox, Rand R. 2011. <em>Introduction to Robust Estimation and Hypothesis Testing</em>. Academic Press.</p>
</div>
</div>
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "true";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
